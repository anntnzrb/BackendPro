@using System.Linq
@model IEnumerable<BackendPro.Core.DTOs.DirectorDto>
@{
    ViewData["Title"] = "Directores";
    var hasDirectores = Model.Any();
}

<div class="section-heading">
    <span>Administración</span>
    <h1>Directores</h1>
</div>
<section class="toolbar">
    <p class="mb-0 text-muted">@Model.Count() registros</p>
    <div class="toolbar-actions">
        <a class="btn btn-primary btn-sm" asp-action="Create" aria-label="Nuevo director"><i class="fas fa-plus"></i></a>
        <button class="btn btn-outline-secondary btn-sm" type="button" aria-label="Buscar"><i class="fas fa-magnifying-glass"></i></button>
    </div>
</section>

@if (!hasDirectores)
{
    @await Html.PartialAsync("_EmptyState", new BackendPro.Web.Models.EmptyStateViewModel
    {
        Icon = "fas fa-user-tie",
        Title = "No hay directores registrados",
        Description = "Crea directores para completar las fichas técnicas de tus películas.",
        ActionText = "Gestionar directores",
        ActionUrl = Url.Action("Index", "Directores")
    })
}
else
{
    <div class="card-grid">
        @foreach (var director in Model)
        {
            var nombre = director.Nombre ?? string.Empty;
            var initials = string.Join(string.Empty, nombre.Split(' ', StringSplitOptions.RemoveEmptyEntries).Take(2).Select(s => char.ToUpperInvariant(s[0])));
            if (string.IsNullOrWhiteSpace(initials))
            {
                initials = "D";
            }
            <article class="profile-card">
                <div class="profile-card-body">
                    <div class="profile-card-header">
                        <div class="profile-avatar">@initials</div>
                        <div>
                            <h3 class="h5 mb-1">@director.Nombre</h3>
                            <span class="badge-soft"><i class="fas fa-flag"></i>@director.Nacionalidad</span>
                        </div>
                    </div>
                    <div class="meta-list">
                        <span><i class="fas fa-calendar-day"></i>Nacimiento: @director.FechaNacimiento.ToString("dd/MM/yyyy")</span>
                    </div>
                    <div class="d-flex gap-2">
                        <a class="btn btn-outline-primary btn-sm" asp-action="Details" asp-route-id="@director.Id" aria-label="Ver detalle"><i class="fas fa-eye"></i></a>
                        <a class="btn btn-outline-secondary btn-sm" asp-action="Edit" asp-route-id="@director.Id" aria-label="Editar"><i class="fas fa-pen"></i></a>
                        <a class="btn btn-outline-danger btn-sm" asp-action="Delete" asp-route-id="@director.Id" aria-label="Eliminar"><i class="fas fa-trash"></i></a>
                    </div>
                </div>
            </article>
        }
    </div>
}
